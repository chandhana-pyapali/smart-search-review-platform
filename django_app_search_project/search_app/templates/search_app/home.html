{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="text-center mb-5">
            <h1 class="display-4 mb-3">
                <i class="fas fa-mobile-alt text-primary"></i>
                App Search Engine
            </h1>
            <p class="lead text-muted">
                Discover amazing apps and read authentic reviews
            </p>
        </div>

        <div class="search-container">
            <form method="GET" action="{% url 'search_results' %}" class="position-relative">
                <div class="input-group input-group-lg">
                    <input 
                        type="text" 
                        name="q" 
                        id="search-input"
                        class="form-control"
                        placeholder="Search for apps..."
                        autocomplete="off"
                        required
                    >
                    <button class="btn btn-primary" type="submit">
                        <i class="fas fa-search"></i> Search
                    </button>
                </div>
                <div id="suggestions" class="suggestions-dropdown"></div>
            </form>
        </div>

        <div class="row mt-5">
            <div class="col-md-4 text-center">
                <div class="feature-box">
                    <i class="fas fa-search fa-3x text-primary mb-3"></i>
                    <h4>Smart Search</h4>
                    <p>Advanced text similarity algorithm for accurate results</p>
                </div>
            </div>
            <div class="col-md-4 text-center">
                <div class="feature-box">
                    <i class="fas fa-star fa-3x text-warning mb-3"></i>
                    <h4>Real Reviews</h4>
                    <p>Authentic user reviews with approval system</p>
                </div>
            </div>
            <div class="col-md-4 text-center">
                <div class="feature-box">
                    <i class="fas fa-mobile-alt fa-3x text-success mb-3"></i>
                    <h4>Detailed Info</h4>
                    <p>Comprehensive app information and statistics</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
$(document).ready(function() {
    $('#search-input').on('input', function() {
        const query = $(this).val();
        if (query.length >= 3) {
            $.get('{% url "search_suggestions" %}', { q: query })
                .done(function(data) {
                    const suggestions = $('#suggestions');
                    suggestions.empty();
                    
                    if (data.length > 0) {
                        data.forEach(function(suggestion) {
                            suggestions.append(
                                `<div class="suggestion-item" data-value="${suggestion}">
                                    ${suggestion}
                                </div>`
                            );
                        });
                        suggestions.show();
                    } else {
                        suggestions.hide();
                    }
                });
        } else {
            $('#suggestions').hide();
        }
    });
    
    $(document).on('click', '.suggestion-item', function() {
        const value = $(this).data('value');
        $('#search-input').val(value);
        $('#suggestions').hide();
    });
    
    $(document).click(function(e) {
        if (!$(e.target).closest('.search-container').length) {
            $('#suggestions').hide();
        }
    });
});
</script>
{% endblock %}